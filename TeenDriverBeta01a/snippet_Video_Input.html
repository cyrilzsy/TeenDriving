<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/hopscotch/0.3.1/css/hopscotch.css">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/hopscotch/0.3.1/js/hopscotch.js"></script>

	<style>
/*		.container-fluid {
			padding-left: 0;
			position: static;
		}
		.container {
			position: absolute;
		}
		.container video {
			position: absolute;
			left: 0;
			top: 0;
		}
		.content {
			position: absolute;
			top: 0;
			color: #f1f1f1;
			z-index: +1;
		}
		.col-container {
			display: table;
			width: 100%;
			padding: 0;
		}
		.col {
			display: table-cell;
			width: 100%;
			padding: 0;
		}*/
		#inputHeader {
			background-color: deepskyblue;
		}
		* {
			box-sizing: border-box;
		}
		#dialog, #history {
			background-color: hsl(0,20%,70%);
			overflow-y: scroll;
			width: auto;
		}
	</style>

	<style>
		button {
			background-color: indigo;
			color:             white;
		}
		.speech-bubble-me {
			position:     relative;
			background:     wheat;
			border-radius:    .4em;
		}
		.speech-bubble-me:after {
			content: '';
			position: absolute;
			left:     0;
			top:    50%;
			width:    0;
			height:   0;
			border:  11px solid transparent;
			border-right-color: wheat;
			border-left:     0;
			margin-top:  -11px;
			margin-left: -11px;
		}
		.speech-bubble-aunt {
			position:     relative;
			background:      brown;
			border-radius:    .4em;
		}
		.speech-bubble-aunt:after {
			content: '';
			position: absolute;
			left:     0;
			top:    50%;
			width:    0;
			height:   0;
			border:  11px solid transparent;
			border-right-color: brown;
			border-left:     0;
			margin-top:  -11px;
			margin-left: -11px;
		}		
	</style>

	<script>
		var w = 0, h = 0;

		function addVideoArea(upperLeftCoords,lowerRightCoords,clickResponse) {
		// video_div
		//   video
		//     source
		//   div#clickAreas
		//     div.content#content0
		//       a
		//         div.clickArea#clickArea0
		//     div.content#content1
		//       a
		//         div.clickArea#clickArea1

		let x = document.getElementsByClassName("clickArea");
		let n = x.length; // number of areas

		let div = document.createElement('div'); // new div.content
		let a = document.createElement('a'); // new link
		let divBox = document.createElement('div'); // new div.clickArea
		a.appendChild(divBox);
		div.appendChild(a);
		$('#clickAreas').append(div); // use jQuery append() instead of HTML DOM appendChild()

		div.setAttribute('class','content');
		div.setAttribute('id','content' + n);

		a.setAttribute('href','#');
		a.onclick = function () {
			$("input").val(clickResponse); // #input is a form in #dialog; it is filled by clickResponse 
			send(); // then clickResponse is sent to DialogFlow
		};

		divBox.setAttribute("class","clickArea");
		divBox.setAttribute("id","clickArea" + n);
		divBox.setAttribute("position","absolute");
		divBox.setAttribute("z-index","+1");

		$("#clickArea" + n).offset({top:upperLeftCoords[1]*h/100,left:upperLeftCoords[0]*w/100});
		$("#clickArea" + n).height((lowerRightCoords[1] - upperLeftCoords[1])*h/100);
		$("#clickArea" + n).width((lowerRightCoords[0] - upperLeftCoords[0])*w/100);

		let alpha = 0.5;
		for (i=0; i<x.length; i++) {
			x[i].style.background = "rgba(0,0,0," + alpha + ")";
			x[i].style.color = "#f1f1f1";
		};
	}

	function getwh() {
		w = $('#video').width();
		h = $('#video').height();		
		$('#dialog').height(h);
	}

	$(window).resize(function () {
		getwh();
	})

	$(document).ready(function() {
		$('#video').on("loadeddata", function () {
			getwh();
			console.log('loadeddata');
		});
		getwh();
	})

	</script>
</head>

<body>
    <div class="container-fluid">
    	<div class="row">
	    	<div class="col-sm-6" style="padding: 0px" id="video_div">
				<video id="video" width="100%">
			    	<source type="video/ogg" id="videoSource" src="28560.ogg">
					Your browser does not support the video tag.
				</video>
				<div id="clickAreas" style="position: absolute; left:0px; top:0px">

				</div>
			</div>
			<div class="col-sm-6" style="padding: 0px">
		    	<div class="col" id="dialog">
					<div class="media-body" style="padding-left:20px" width="100%">
						<div style="padding: 15px; color: black; width: auto" class="speech-bubble-me">
							Yes, let's start
							<button onclick="addVideoArea([10,20],[50,60],'!')">AddClickArea</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
<!--     <div class="col-container">
    	<div class="col">
    		<div id="video_box" class="container-fluid">
				<video id="video" width="100%">
			    	<source type="video/ogg" id="videoSource" src="28560.ogg">
					Your browser does not support the video tag.
				</video>
				<div id="clickAreas">

				</div>
     		</div>
		</div>
    	<div class="col" id="dialog">
			<div class="media-body" style="padding-left:20px">
				<div style="padding: 15px; color: black; width: auto" class="speech-bubble-me">
					Yes, let's start
					<button onclick="addVideoArea([0,0],[480,320],'!')">AddClickArea</button>
				</div>
			</div>
		</div>
	</div> -->
</body>

</html>